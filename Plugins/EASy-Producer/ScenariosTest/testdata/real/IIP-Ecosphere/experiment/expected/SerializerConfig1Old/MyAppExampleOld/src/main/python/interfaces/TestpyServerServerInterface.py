from AbstractService import AbstractService
import Registry
from Version import Version
from Service import ServiceState
from Service import ServiceKind

class TestpyServerServerInterface(AbstractService):
    """Interface for server "test-pyServer"
       Generated by: EASy-Producer."""

    ingestor = None    
    def __init__(self):
        """Initializes the server service.""" 
        super().__init__("test-pyServer", "test-pyServer", Version("1.3.0"), "Test server", True, ServiceKind.SERVER)
        Registry.services['test-pyServer'] = self

    def attachIngestor(self, ingestor):
        """Called by ServiceEnvironment to attach an individual type-generic ingestor, i.e., a function 
           that allows to asynchronously ingest result data back into stream processing. The ingestor
           cares for the type and the target stream.
        Parameters:
            - ingestor -- the ingestor function
        """
        self.ingestor = ingestor

    def ingest(self, data):
        """Ingests result data asynchronously into stream processing. Target stream and data type are 
           handled by the ingestor.
        Parameters:
            - data -- the data to ingest; if the type is unknown/no type translator registered, nothing will happen
        """
        if self.ingestor is not None:
            self.ingestor(data)
    
    def setState(self, state: ServiceState):
        """Changes the state. [R133c]
        
        Parameters:
          - state (ServiceState) -- the new state
        """
        super().setState(state)
        if state==ServiceState.STARTING:
            self.start()
        if state==ServiceState.STOPPING:
            self.stop()
            
    def start(self):
        """Called when the server shall start."""
        pass

    def stop(self):
        """Called when the server shall stop."""
        pass
            
    def receivedClientServer(self, data):
        """Called when data on client-server connection arrives.
        
        Parameters:
          - data -- the data (type depends on client-server implementation)
        """
        pass
